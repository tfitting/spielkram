<!DOCTYPE html>
<html lang="de">
    <head>
        <meta charset="utf-8" />
        <title>Javascript canvas</title>
        <meta name="description" content="CANVAS" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
        <script>
            
            function getTimeEntries(){
                
                // Must have: Sortierung nach Start/Ende
                return [
                    { id: 1, timeStart: "09:30", timeEnd: "11:00", text: "Termin 1" },
                    { id: 2, timeStart: "09:30", timeEnd: "10:30", text: "Termin 2" },
                    { id: 3, timeStart: "10:00", timeEnd: "10:30", text: "Termin 3" },
                    { id: 4, timeStart: "10:30", timeEnd: "12:00", text: "Termin 4" },
                    { id: 5, timeStart: "11:30", timeEnd: "12:30", text: "Termin 5" },
                    { id: 6, timeStart: "11:30", timeEnd: "12:30", text: "Termin 6" },
                    { id: 7, timeStart: "11:30", timeEnd: "12:30", text: "Termin 7" },
                ];
            };
            
            function minutes( timeString ){
                return ( Number( timeString.split(":")[0] ) * 60 ) + Number( timeString.split(":")[1] )
            };
            
            function entriesOverlap(A, B){
                if ( ( minutes(A.timeStart ) < minutes( B.timeEnd   ) ) // A beginnt  bevor B aufhört
                  && ( minutes(A.timeEnd   ) > minutes( B.timeStart ) ) )   // A hört auf nachdem B beginnt 
                {
                    return true;
                }else{
                    return false;      
                }
            };
            
            function addOverlapping(currentEntry, timeEntries){
                var level = 0;
                var group = [];
                var current = currentEntry;
                
                currentEntry["overlapping"] = timeEntries.filter(function(entry){
                    if ( ( entry.id != current.id )
                         && entriesOverlap( entry, current )
                       ){
                        return true;
                    }else{
                        return false;
                    }
                })

            };

            function addOverlappingCount(
                currentEntry,
                processedEntries
                maxOverlappings,
            ){
                var toProcess = currentEntry.overlapping.filter(function(overlappingEntry){
                    
                    processedEntries.map(function(processed){
                        if (processed.id = overlapping.id) { return true };
                        
                        
                    })
                
                })
                if (currentEntry)

                    
                                    var currentOverlappings

                    
                maximale Überlappungen zum Starzeitpunkt des Termins oder eines Termins in der Überlappungskette
            
            } 
            
            
            
            
            function init(){
                
                var timeEntries = getTimeEntries();
                
                timeEntries.map(function(entry){
                    addOverlapping(entry, timeEntries)
                });
                
                console.log( timeEntries );
            };
            
/*            
            
            
            
            
            
            
            
            
            function getUnits()
            {
                return [1,2,3,4,5,6,7,8];
            }

            function getYCoordFromUnit(unit)
            {
                return 20 + ( unit * 10 );
            }
            
            function init()
            {
                var canvas = document.getElementById('timeline');
                if (canvas && canvas.getContext) {
                    var ctx = canvas.getContext("2d");               
                    render(ctx);                
                }
            }
            function render(ctx)
            {
                if (ctx)
                {
                    ctx.fillStyle = "#000000";
                    
                    renderRasterEntry = function(yCoord)
                    {
                        
                       ctx.strokeStyle = "#9C9CFF";                       
                       ctx.beginPath();
                       ctx.moveTo(20, yCoord );
                       ctx.lineTo(50, yCoord );
                       ctx.stroke();
                       
                       ctx.fillStyle = "#ff0000";
                       ctx.font = "14px Verdana";
                       var myString = "test";
                       ctx.fillText(myString, 60, yCoord );
                    
                    }

                    getUnits()
                        .map(getYCoordFromUnit)
                        .map(renderRasterEntry)
                    
               }
                
            }
*/
            
        </script>
        
    </head>
    <body onload="init();">
        <canvas id="timeline" width="200" height="600"> </canvas>        
        <script src="jquery-2.1.3.js"/>
    </body>
</html>
